<!DOCTYPE html>
<html lang="en">
<head>
    <title>Password Reset</title>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css.css">
</head>

<script type="module" src="API.js"></script>

<body>
    <div class="content">
        <h1>Password Reset</h1>
        <form id="passwordResetForm">
            <label for="verificationCode">Verification code:</label>
            <input type="text" id="verificationCode" name="verificationCode" required>
            <br>
            <label for="newPassword">Set New password:</label>
            <input type="password" id="newPassword" name="newPassword" required>
            <br>
            <button type="submit" id="saveBackBtn">Save and back</button>
        </form>
    </div>

    <script type="module">
        import FrontEndAPI from './API.js';

        const api = new FrontEndAPI('/api'); // Adjust the path as necessary

        document.getElementById('passwordResetForm').addEventListener('submit', async (event) => {
            event.preventDefault(); // Prevent the default form submission

            const verificationCode = document.getElementById('verificationCode').value;
            const newPassword = document.getElementById('newPassword').value;

            if (verificationCode && newPassword) {
                try {
                    const response = await api.resetPassword(verificationCode, newPassword);
                    alert(response.message); // Show a success message
                    window.location.href = '/login'; // Redirect to the login page
                } catch (error) {
                    console.error('Error resetting password:', error);
                    alert('Failed to reset password. Please check the verification code and try again.');
                }
            } else {
                alert('Both fields are required.');
            }
        });
    </script>

</body>

</html>